<?php

function cvet($str)
{
	$str = str_replace("00","0",$str);

	$str = str_replace("10","17",$str);
	$str = str_replace("11","18",$str);
	$str = str_replace("12","19",$str);
	$str = str_replace("13","20",$str);
	$str = str_replace("14","21",$str);
	$str = str_replace("15","22",$str);
	$str = str_replace("16","23",$str);
	$str = str_replace("17","24",$str);
	$str = str_replace("18","25",$str);
	$str = str_replace("19","26",$str);
	$str = str_replace("1a","27",$str);
	$str = str_replace("1b","28",$str);
	$str = str_replace("1c","29",$str);
	$str = str_replace("1d","30",$str);
	$str = str_replace("1e","31",$str);
	$str = str_replace("1f","32",$str);
	$str = str_replace("1A","27",$str);
	$str = str_replace("1B","28",$str);
	$str = str_replace("1C","29",$str);
	$str = str_replace("1D","30",$str);
	$str = str_replace("1E","31",$str);
	$str = str_replace("1F","32",$str);

	$str = str_replace("20","33",$str);
	$str = str_replace("21","34",$str);
	$str = str_replace("22","35",$str);
	$str = str_replace("23","36",$str);
	$str = str_replace("24","37",$str);
	$str = str_replace("25","38",$str);
	$str = str_replace("26","39",$str);
	$str = str_replace("27","40",$str);
	$str = str_replace("28","41",$str);
	$str = str_replace("29","42",$str);
	$str = str_replace("2a","43",$str);
	$str = str_replace("2b","44",$str);
	$str = str_replace("2c","45",$str);
	$str = str_replace("2d","46",$str);
	$str = str_replace("2e","47",$str);
	$str = str_replace("2f","48",$str);
	$str = str_replace("2A","43",$str);
	$str = str_replace("2B","44",$str);
	$str = str_replace("2C","45",$str);
	$str = str_replace("2D","46",$str);
	$str = str_replace("2E","47",$str);
	$str = str_replace("2F","48",$str);

	$str = str_replace("30","49",$str);
	$str = str_replace("31","50",$str);
	$str = str_replace("32","51",$str);
	$str = str_replace("33","52",$str);
	$str = str_replace("34","53",$str);
	$str = str_replace("35","54",$str);
	$str = str_replace("36","55",$str);
	$str = str_replace("37","56",$str);
	$str = str_replace("38","57",$str);
	$str = str_replace("39","58",$str);
	$str = str_replace("3a","59",$str);
	$str = str_replace("3b","60",$str);
	$str = str_replace("3c","61",$str);
	$str = str_replace("3d","62",$str);
	$str = str_replace("3e","63",$str);
	$str = str_replace("3f","64",$str);
	$str = str_replace("3A","59",$str);
	$str = str_replace("3B","60",$str);
	$str = str_replace("3C","61",$str);
	$str = str_replace("3D","62",$str);
	$str = str_replace("3E","63",$str);
	$str = str_replace("3F","64",$str);

	$str = str_replace("40","65",$str);
	$str = str_replace("41","66",$str);
	$str = str_replace("42","67",$str);
	$str = str_replace("43","68",$str);
	$str = str_replace("44","69",$str);
	$str = str_replace("45","70",$str);
	$str = str_replace("46","71",$str);
	$str = str_replace("47","72",$str);
	$str = str_replace("48","73",$str);
	$str = str_replace("49","74",$str);
	$str = str_replace("4a","75",$str);
	$str = str_replace("4b","76",$str);
	$str = str_replace("4c","77",$str);
	$str = str_replace("4d","78",$str);
	$str = str_replace("4e","79",$str);
	$str = str_replace("4f","80",$str);
	$str = str_replace("4A","75",$str);
	$str = str_replace("4B","76",$str);
	$str = str_replace("4C","77",$str);
	$str = str_replace("4D","78",$str);
	$str = str_replace("4E","79",$str);
	$str = str_replace("4F","80",$str);

	$str = str_replace("50","81",$str);
	$str = str_replace("51","82",$str);
	$str = str_replace("52","83",$str);
	$str = str_replace("53","84",$str);
	$str = str_replace("54","85",$str);
	$str = str_replace("55","86",$str);
	$str = str_replace("56","87",$str);
	$str = str_replace("57","88",$str);
	$str = str_replace("58","89",$str);
	$str = str_replace("59","90",$str);
	$str = str_replace("5a","91",$str);
	$str = str_replace("5b","92",$str);
	$str = str_replace("5c","93",$str);
	$str = str_replace("5d","94",$str);
	$str = str_replace("5e","95",$str);
	$str = str_replace("5f","96",$str);
	$str = str_replace("5A","91",$str);
	$str = str_replace("5B","92",$str);
	$str = str_replace("5C","93",$str);
	$str = str_replace("5D","94",$str);
	$str = str_replace("5E","95",$str);
	$str = str_replace("5F","96",$str);

	$str = str_replace("60","96",$str);
	$str = str_replace("61","97",$str);
	$str = str_replace("62","98",$str);
	$str = str_replace("63","99",$str);
	$str = str_replace("64","100",$str);
	$str = str_replace("65","101",$str);
	$str = str_replace("66","102",$str);
	$str = str_replace("67","103",$str);
	$str = str_replace("68","104",$str);
	$str = str_replace("69","105",$str);
	$str = str_replace("6a","106",$str);
	$str = str_replace("6b","107",$str);
	$str = str_replace("6c","108",$str);
	$str = str_replace("6d","109",$str);
	$str = str_replace("6e","110",$str);
	$str = str_replace("6f","111",$str);
	$str = str_replace("6A","106",$str);
	$str = str_replace("6B","107",$str);
	$str = str_replace("6C","108",$str);
	$str = str_replace("6D","109",$str);
	$str = str_replace("6E","110",$str);
	$str = str_replace("6F","111",$str);

	$str = str_replace("70","112",$str);
	$str = str_replace("71","113",$str);
	$str = str_replace("72","114",$str);
	$str = str_replace("73","115",$str);
	$str = str_replace("74","116",$str);
	$str = str_replace("75","117",$str);
	$str = str_replace("76","118",$str);
	$str = str_replace("77","119",$str);
	$str = str_replace("78","120",$str);
	$str = str_replace("79","121",$str);
	$str = str_replace("7a","122",$str);
	$str = str_replace("7b","123",$str);
	$str = str_replace("7c","124",$str);
	$str = str_replace("7d","125",$str);
	$str = str_replace("7e","126",$str);
	$str = str_replace("7f","127",$str);
	$str = str_replace("7A","122",$str);
	$str = str_replace("7B","123",$str);
	$str = str_replace("7C","124",$str);
	$str = str_replace("7D","125",$str);
	$str = str_replace("7E","126",$str);
	$str = str_replace("7F","127",$str);

	$str = str_replace("80","128",$str);
	$str = str_replace("81","129",$str);
	$str = str_replace("82","130",$str);
	$str = str_replace("83","131",$str);
	$str = str_replace("84","132",$str);
	$str = str_replace("85","133",$str);
	$str = str_replace("86","134",$str);
	$str = str_replace("87","135",$str);
	$str = str_replace("88","136",$str);
	$str = str_replace("89","137",$str);
	$str = str_replace("8a","138",$str);
	$str = str_replace("8b","139",$str);
	$str = str_replace("8c","140",$str);
	$str = str_replace("8d","141",$str);
	$str = str_replace("8e","142",$str);
	$str = str_replace("8f","143",$str);
	$str = str_replace("8A","138",$str);
	$str = str_replace("8B","139",$str);
	$str = str_replace("8C","140",$str);
	$str = str_replace("8D","141",$str);
	$str = str_replace("8E","142",$str);
	$str = str_replace("8F","143",$str);

	$str = str_replace("90","144",$str);
	$str = str_replace("91","145",$str);
	$str = str_replace("92","146",$str);
	$str = str_replace("93","147",$str);
	$str = str_replace("94","148",$str);
	$str = str_replace("95","149",$str);
	$str = str_replace("96","150",$str);
	$str = str_replace("97","151",$str);
	$str = str_replace("98","152",$str);
	$str = str_replace("99","153",$str);
	$str = str_replace("9a","154",$str);
	$str = str_replace("9b","155",$str);
	$str = str_replace("9c","156",$str);
	$str = str_replace("9d","157",$str);
	$str = str_replace("9e","158",$str);
	$str = str_replace("9f","159",$str);
	$str = str_replace("9A","154",$str);
	$str = str_replace("9B","155",$str);
	$str = str_replace("9C","156",$str);
	$str = str_replace("9D","157",$str);
	$str = str_replace("9E","158",$str);
	$str = str_replace("9F","159",$str);

	$str = str_replace("a0","160",$str);
	$str = str_replace("a1","161",$str);
	$str = str_replace("a2","162",$str);
	$str = str_replace("a3","163",$str);
	$str = str_replace("a4","164",$str);
	$str = str_replace("a5","165",$str);
	$str = str_replace("a6","166",$str);
	$str = str_replace("a7","167",$str);
	$str = str_replace("a8","168",$str);
	$str = str_replace("a9","169",$str);
	$str = str_replace("aa","170",$str);
	$str = str_replace("ab","171",$str);
	$str = str_replace("ac","172",$str);
	$str = str_replace("ad","173",$str);
	$str = str_replace("ae","174",$str);
	$str = str_replace("af","175",$str);
	$str = str_replace("A0","160",$str);
	$str = str_replace("A1","161",$str);
	$str = str_replace("A2","162",$str);
	$str = str_replace("A3","163",$str);
	$str = str_replace("A4","164",$str);
	$str = str_replace("A5","165",$str);
	$str = str_replace("A6","166",$str);
	$str = str_replace("A7","167",$str);
	$str = str_replace("A8","168",$str);
	$str = str_replace("A9","169",$str);
	$str = str_replace("AA","170",$str);
	$str = str_replace("AB","171",$str);
	$str = str_replace("AC","172",$str);
	$str = str_replace("AD","173",$str);
	$str = str_replace("AE","174",$str);
	$str = str_replace("AF","175",$str);

	$str = str_replace("b0","176",$str);
	$str = str_replace("b1","177",$str);
	$str = str_replace("b2","178",$str);
	$str = str_replace("b3","179",$str);
	$str = str_replace("b4","180",$str);
	$str = str_replace("b5","181",$str);
	$str = str_replace("b6","182",$str);
	$str = str_replace("b7","183",$str);
	$str = str_replace("b8","184",$str);
	$str = str_replace("b9","185",$str);
	$str = str_replace("ba","186",$str);
	$str = str_replace("bb","187",$str);
	$str = str_replace("bc","188",$str);
	$str = str_replace("bd","189",$str);
	$str = str_replace("be","190",$str);
	$str = str_replace("bf","191",$str);
	$str = str_replace("B0","176",$str);
	$str = str_replace("B1","177",$str);
	$str = str_replace("B2","178",$str);
	$str = str_replace("B3","179",$str);
	$str = str_replace("B4","180",$str);
	$str = str_replace("B5","181",$str);
	$str = str_replace("B6","182",$str);
	$str = str_replace("B7","183",$str);
	$str = str_replace("B8","184",$str);
	$str = str_replace("B9","185",$str);
	$str = str_replace("BA","186",$str);
	$str = str_replace("BB","187",$str);
	$str = str_replace("BC","188",$str);
	$str = str_replace("BD","189",$str);
	$str = str_replace("BE","190",$str);
	$str = str_replace("BF","191",$str);

	$str = str_replace("c0","192",$str);
	$str = str_replace("c1","193",$str);
	$str = str_replace("c2","194",$str);
	$str = str_replace("c3","195",$str);
	$str = str_replace("c4","196",$str);
	$str = str_replace("c5","197",$str);
	$str = str_replace("c6","198",$str);
	$str = str_replace("c7","199",$str);
	$str = str_replace("c8","200",$str);
	$str = str_replace("c9","201",$str);
	$str = str_replace("ca","202",$str);
	$str = str_replace("cb","203",$str);
	$str = str_replace("cc","204",$str);
	$str = str_replace("cd","205",$str);
	$str = str_replace("ce","206",$str);
	$str = str_replace("cf","207",$str);
	$str = str_replace("C0","192",$str);
	$str = str_replace("C1","193",$str);
	$str = str_replace("C2","194",$str);
	$str = str_replace("C3","195",$str);
	$str = str_replace("C4","196",$str);
	$str = str_replace("C5","197",$str);
	$str = str_replace("C6","198",$str);
	$str = str_replace("C7","199",$str);
	$str = str_replace("C8","200",$str);
	$str = str_replace("C9","201",$str);
	$str = str_replace("CA","202",$str);
	$str = str_replace("CB","203",$str);
	$str = str_replace("CC","204",$str);
	$str = str_replace("CD","205",$str);
	$str = str_replace("CE","206",$str);
	$str = str_replace("CF","207",$str);

	$str = str_replace("d0","208",$str);
	$str = str_replace("d1","209",$str);
	$str = str_replace("d2","210",$str);
	$str = str_replace("d3","211",$str);
	$str = str_replace("d4","212",$str);
	$str = str_replace("d5","213",$str);
	$str = str_replace("d6","214",$str);
	$str = str_replace("d7","215",$str);
	$str = str_replace("d8","216",$str);
	$str = str_replace("d9","217",$str);
	$str = str_replace("da","218",$str);
	$str = str_replace("db","219",$str);
	$str = str_replace("dc","220",$str);
	$str = str_replace("dd","221",$str);
	$str = str_replace("de","222",$str);
	$str = str_replace("df","223",$str);
	$str = str_replace("D0","208",$str);
	$str = str_replace("D1","209",$str);
	$str = str_replace("D2","210",$str);
	$str = str_replace("D3","211",$str);
	$str = str_replace("D4","212",$str);
	$str = str_replace("D5","213",$str);
	$str = str_replace("D6","214",$str);
	$str = str_replace("D7","215",$str);
	$str = str_replace("D8","216",$str);
	$str = str_replace("D9","217",$str);
	$str = str_replace("DA","218",$str);
	$str = str_replace("DB","219",$str);
	$str = str_replace("DC","220",$str);
	$str = str_replace("DD","221",$str);
	$str = str_replace("DE","222",$str);
	$str = str_replace("DF","223",$str);

	$str = str_replace("e0","224",$str);
	$str = str_replace("e1","225",$str);
	$str = str_replace("e2","226",$str);
	$str = str_replace("e3","227",$str);
	$str = str_replace("e4","228",$str);
	$str = str_replace("e5","229",$str);
	$str = str_replace("e6","230",$str);
	$str = str_replace("e7","231",$str);
	$str = str_replace("e8","232",$str);
	$str = str_replace("e9","233",$str);
	$str = str_replace("ea","234",$str);
	$str = str_replace("eb","235",$str);
	$str = str_replace("ec","236",$str);
	$str = str_replace("ed","237",$str);
	$str = str_replace("ee","238",$str);
	$str = str_replace("ef","239",$str);
	$str = str_replace("E0","224",$str);
	$str = str_replace("E1","225",$str);
	$str = str_replace("E2","226",$str);
	$str = str_replace("E3","227",$str);
	$str = str_replace("E4","128",$str);
	$str = str_replace("E5","129",$str);
	$str = str_replace("E6","130",$str);
	$str = str_replace("E7","231",$str);
	$str = str_replace("E8","232",$str);
	$str = str_replace("E9","233",$str);
	$str = str_replace("EA","234",$str);
	$str = str_replace("EB","235",$str);
	$str = str_replace("EC","236",$str);
	$str = str_replace("ED","237",$str);
	$str = str_replace("EE","238",$str);
	$str = str_replace("EF","239",$str);

	$str = str_replace("f0","240",$str);
	$str = str_replace("f1","241",$str);
	$str = str_replace("f2","242",$str);
	$str = str_replace("f3","243",$str);
	$str = str_replace("f4","244",$str);
	$str = str_replace("f5","245",$str);
	$str = str_replace("f6","246",$str);
	$str = str_replace("f7","247",$str);
	$str = str_replace("f8","248",$str);
	$str = str_replace("f9","249",$str);
	$str = str_replace("fa","250",$str);
	$str = str_replace("fb","251",$str);
	$str = str_replace("fc","252",$str);
	$str = str_replace("fd","253",$str);
	$str = str_replace("fe","254",$str);
	$str = str_replace("ff","255",$str);
	$str = str_replace("F0","240",$str);
	$str = str_replace("F1","241",$str);
	$str = str_replace("F2","242",$str);
	$str = str_replace("F3","243",$str);
	$str = str_replace("F4","244",$str);
	$str = str_replace("F5","245",$str);
	$str = str_replace("F6","246",$str);
	$str = str_replace("F7","247",$str);
	$str = str_replace("F8","248",$str);
	$str = str_replace("F9","249",$str);
	$str = str_replace("FA","250",$str);
	$str = str_replace("FB","251",$str);
	$str = str_replace("FC","252",$str);
	$str = str_replace("FD","253",$str);
	$str = str_replace("FE","254",$str);
	$str = str_replace("FF","255",$str);

	return $str;
}



$p_bg1=htmlspecialchars(cvet(substr($_POST[bg], 0, 2)));
$p_bg2=htmlspecialchars(cvet(substr($_POST[bg], 2, 2)));
$p_bg3=htmlspecialchars(cvet(substr($_POST[bg], 4, 2)));

$p_txtcolor1=htmlspecialchars(cvet(substr($_POST[txtcolor], 0, 2)));
$p_txtcolor2=htmlspecialchars(cvet(substr($_POST[txtcolor], 2, 2)));
$p_txtcolor3=htmlspecialchars(cvet(substr($_POST[txtcolor], 4, 2)));


$p_font=htmlspecialchars($_POST['font']);            
$p_text=htmlspecialchars($_POST['text']);           
$p_angle=htmlspecialchars($_POST['angle']);          
$p_size=htmlspecialchars($_POST['size']);            
$p_format=htmlspecialchars($_POST['format']);      
$b_alpha=htmlspecialchars($_POST['b_alpha']);        


if (ereg("[A-Za-zа-яА-Я,$,>,<,',`,;,/,\,&,#,,,.,:,*,@,!,%,^,(,)]","$p_angle$p_size"))
{
	$p_angle=0; $p_size=20;
}

if (ereg("[A-Za-zа-яА-Я,$,>,<,',`,;,/,\,&,#,,,.,:,*,@,!,%,^,(,)]","$b_alpha"))
{
	$b_alpha=0;
}

if (ereg("[J-Zj-zа-яА-Я,$,>,<,',`,;,/,\,&,#,,,.,:,*,@,!,%,^,(,)]","$p_bg1$p_bg2$p_bg3$p_txtcolor1$p_txtcolor2$p_txtcolor3"))
{
include "../head.php";
echo "<center class=\"b\">	kí tự k hợp lệ!!!<br/><a href=\"create.php\">trở lại</a></center>";
include "../foot.php";
exit;
}

if (ereg("[а-яА-Я,$,>,<,',`,;,/,\,&,#,,,:,*,@,!,%,^,(,)]","$p_text"))
{
include "../head.php";
echo "<center class=\"b\">chỉ sử dụng kí tự Latin!<a href=\"create.php\">trở lại</a></center>";
include "../foot.php";
exit;
}


if ($b_alpha>127){$b_alpha="127";}elseif($b_alpha==0){$b_alpha="0";}elseif($b_alpha==""){$b_alpha="0";}
if ($p_font==""){ include "../head.php"; echo "<center class=\"b\">	Lỗi font!!!<br/><a href=\"create.php\">trở lại</a></center>"; 
include "../foot.php"; exit; }
if ($p_size>40){$p_size="40";} 
if ($p_angle==""){$p_angle="0";} 
if ($p_angle>180){$p_angle="180";} 
if ($p_angle<-180){$p_angle="-180";} 
if ($p_text==""){$p_text="wapadmin.info";}  
if ($p_text=="wapadmin.info"){$b_alpha="127"; $p_format="png";}
include("../head.php");


$image="image.php?text=$p_text&amp;angle=$p_angle&amp;size=$p_size&amp;bg1=$p_bg1&amp;bg2=$p_bg2&amp;bg3=$p_bg3&amp;txtcolor1=$p_txtcolor1&amp;txtcolor2=$p_txtcolor2&amp;txtcolor3=$p_txtcolor3&amp;font=$p_font&amp;format=$p_format&amp;b_alpha=$b_alpha";
echo "<center class=\"b\"><img src=\"$image\"><br/>";
echo "<a href=\"$image\">	Tải về</a><br/>";
echo "<a href=\"create.php\">Thành Công!</a></center>";

include("../foot.php");
?>